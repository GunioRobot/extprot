USE_OCAMLFIND = true
NATIVE_ENABLED = true
BYTE_ENABLED = true

OCAMLDEPFLAGS = -pp "camlp4orf"
OCAMLFLAGS = -dtypes -pp "camlp4orf" -for-pack Extprot
OCAMLOPTFLAGS = -inline 100 

OCAMLPACKS[] =
	camlp4
	extlib

EXTPROT_OBJS[] =
	parser
	ptypes
	gencode

section
	OCAMLFLAGS =
	OCamlPackage(extprot, $(EXTPROT_OBJS))
	OCamlLibrary(extprot, extprot)

%.sig: %.ml %.cmo
	$(OCAMLFIND) $(OCAMLC) -package $(concat \,, $(OCAMLPACKS)) \
	    $(mapprefix -I, $(OCAMLINCLUDES)) \
	    $(OCAMLFLAGS) $(OCAMLCFLAGS) -i $< > $@

.DEFAULT: extprot.cma extprot.cmxa
