OCAMLPACKS [] += oUnit

OCAMLINCLUDES += $(ROOT)/runtime

OCAML_LIBS[] +=
    $(ROOT)/runtime/extprot

TEST_MODULES[] =
    test_types
    gen_data
    unit_write

GENERATOR = ../sample

OCAMLDEP_MODULES_ENABLED = false
LocalOCamlGeneratedFiles(test_types.ml)

test_types.ml: $(GENERATOR) test_types.proto
    $(GENERATOR) test_types.proto > $@

$(CamlTargets test_types): $(ROOT)/runtime/extprot.cmxa

OCamlProgram(test, register_test $(TEST_MODULES) test)
OCamlProgram(bm_01, test_types gen_data bm_01)

.DEFAULT: test bm_01

.PHONY: clean
clean:
	rm -f $(filter-proper-targets $(ls R, .)) *.annot
