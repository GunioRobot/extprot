OCAMLINCLUDES[] += $(BASE)/runtime
OCAML_LIBS[] =
	$(BASE)/runtime/extprot

OCAMLFLAGS += -syntax camlp4o
OCAMLDEPFLAGS += -syntax camlp4o

OCAMLPACKS[] +=
	camlp4.quotations
	sexplib
	sexplib.syntax

EXTPROT_OBJS[] =
	parser
	ptypes
	protocol_types
	gencode
	gencode_types
	gen_OCaml

section
	OCAMLPACKS[] += camlp4.extend
	OCAMLFLAGS += -w e
	CamlSources(parser)

section
	OCAMLFLAGS += -w e
	CamlSources(protocol_types gencode_types)

OCAMLPACKS += camlp4.lib
OCamlProgram(extprotc, $(EXTPROT_OBJS) extprotc)

.DEFAULT: extprotc$(EXE)

.PHONY: clean
clean:
	rm -f $(filter-proper-targets $(ls R, .)) *.s *.annot
